
@{
    ViewBag.Title = "Lịch xem nhà";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

@section Header{

    <div class="d-flex align-items-center flex-wrap mr-1">

        <button class="btn btn-icon mr-4" id="kt_aside_toggle">
            <span class="svg-icon svg-icon-xl">

                <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="24px" height="24px" viewBox="0 0 24 24" version="1.1">
                    <g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
                        <rect x="0" y="0" width="24" height="24" />
                        <path d="M2 11.5C2 12.3284 2.67157 13 3.5 13H20.5C21.3284 13 22 12.3284 22 11.5V11.5C22 10.6716 21.3284 10 20.5 10H3.5C2.67157 10 2 10.6716 2 11.5V11.5Z" fill="black" />
                        <path opacity="0.5" fill-rule="evenodd" clip-rule="evenodd" d="M9.5 20C8.67157 20 8 19.3284 8 18.5C8 17.6716 8.67157 17 9.5 17H20.5C21.3284 17 22 17.6716 22 18.5C22 19.3284 21.3284 20 20.5 20H9.5ZM15.5 6C14.6716 6 14 5.32843 14 4.5C14 3.67157 14.6716 3 15.5 3H20.5C21.3284 3 22 3.67157 22 4.5C22 5.32843 21.3284 6 20.5 6H15.5Z" fill="black" />
                    </g>
                </svg>

            </span>
        </button>

        <div class="d-flex align-items-baseline flex-wrap mr-5">

            <h5 class="text-dark font-weight-bold my-1 mr-5">
               Lịch xem nhà
            </h5>
            
        </div>
    </div>

    <div class="d-flex align-items-center">
       
    </div>

}
<div class="row">
    <div class="col-lg-12">

    </div>
</div>
<div class="card card-custom gutter-b">
    <div class="card-body">
     
        <div id="danh-sach">

        </div>
    </div>
</div>

@section ScriptsFile{

    <script src="~/Scripts/parsley.min.js"></script>
}
@section CustomScripts{
    <script type="text/javascript">
        var id = 0;
               var dataSource = new DevExpress.data.CustomStore({
            load: function (loadOptions) {
                var deferred = $.Deferred(), params = {}, filter = [];
                if (loadOptions.sort) {
                    params.sort = JSON.stringify(loadOptions.sort);
                }
                if (loadOptions.filter) {
                    var fil = JSON.stringify(loadOptions.filter[0][0]);
                    params.fill = fil;
                }
              
                if (loadOptions.select) {
                    params.select = JSON.stringify(loadOptions.select);
                }

               
                params.Tuan = true; 
       
                $.getJSON("@Url.Action("GetLichXemNha", "LichXemNha")", params)
                    .done(function (result) {
                        data = JSON.parse(result); 
                        if (data != null && data.length > 0) {
                            deferred.resolve(data, { totalCount: data.length });
                        }
                        else {
                            deferred.resolve([], { totalCount: 0 });
                        }
                    })
                    .fail(function (jqxhr, textStatus, error) {
                        deferred.reject("Data Loading Error");
                    });
                return deferred.promise();
            }
        });
         $(function () {

             $("#danh-sach").dxScheduler({
                 dataSource: dataSource,
                 views: ["week","month"],
                 currentView: "month",
                 currentDate: new Date(),
                 firstDayOfWeek: 0,
                 startDayHour: 7,
                 endDayHour: 18,
                 showAllDayPanel: false,
                 appointmentTemplate: function (model) {
                     return $('<div class="noi_dung_tb"><span style="margin-bottom:10px;" class="pt-5 pb-5"><i class="text-white flaticon-alert"></i>  ' + model.appointmentData.ma_can + '</span></div>' + '<div class="noi_dung_tb mt-5"><span ><i class="flaticon2-chat-2 text-white"></i> ' + model.appointmentData.ten_khach_hang + '</span></div>');
                 },

                 remoteFiltering: true,
                 appointmentTooltipTemplate: function (model) {

                     return $("<div class='movie-tooltip'>" +

                         "<div class='movie-info'>" +
                         '<div style="text-align: left; font-weight: bold; font-size: 16px; letter-spacing: .01em; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;"><i class="flaticon-home" style="color:rgb(86, 202, 133)"></i> ' +
                         model.appointmentData.ma_can +
                         "</div>" +
                         '<div style="text-align: left;padding-top:5px">' +
                         "Thời gian: " + Globalize.format(new Date(model.appointmentData.startDate), 'HH:mm') + ' - ' + Globalize.format(new Date(model.appointmentData.endDate), 'HH:mm') +
                         "</div>" +
                         '<div style="text-align: left;padding-top:5px">' +
                         "Khách hàng: " + (model.appointmentData.ten_khach_hang == null ? '' : model.appointmentData.ten_khach_hang) +
                         "</div>" +
                         '<div style="text-align: left;padding-top:5px;white-space: pre-wrap;">' +
                         "Điện thoại: " + (model.appointmentData.so_dien_thoi == null ? '' : model.appointmentData.so_dien_thoi) + " " +
                         "</div>" +
                         "</div>" +
                         "</div>");
                 },
             });


        });
        

    </script>
}