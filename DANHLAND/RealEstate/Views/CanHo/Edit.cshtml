@{
    //ViewBag.Title = Model.TieuDe;
    Layout = "~/Views/Shared/_Layout.cshtml";
    string imgs_key = Model.IDCanHo.ToString();
}
@section CSSFileTop{
    <link href="~/Content/css/uppy.bundle.css" rel="stylesheet" />
    <style>
        #addImages {
            border: 1px solid black;
            border-radius: 20px;
            overflow: hidden;
            width: 100px;
            height: 100px;
            position: relative;
            display: block;
            z-index: 10;
            background-color:beige
        }
    </style>
}
@section Header{
    <div class="d-flex align-items-center flex-wrap mr-1">
        <button class="btn btn-icon mr-4" id="kt_aside_toggle">
            <span class="svg-icon svg-icon-xl">
                <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="24px" height="24px" viewBox="0 0 24 24" version="1.1">
                    <g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
                        <rect x="0" y="0" width="24" height="24" />
                        <path d="M2 11.5C2 12.3284 2.67157 13 3.5 13H20.5C21.3284 13 22 12.3284 22 11.5V11.5C22 10.6716 21.3284 10 20.5 10H3.5C2.67157 10 2 10.6716 2 11.5V11.5Z" fill="black" />
                        <path opacity="0.5" fill-rule="evenodd" clip-rule="evenodd" d="M9.5 20C8.67157 20 8 19.3284 8 18.5C8 17.6716 8.67157 17 9.5 17H20.5C21.3284 17 22 17.6716 22 18.5C22 19.3284 21.3284 20 20.5 20H9.5ZM15.5 6C14.6716 6 14 5.32843 14 4.5C14 3.67157 14.6716 3 15.5 3H20.5C21.3284 3 22 3.67157 22 4.5C22 5.32843 21.3284 6 20.5 6H15.5Z" fill="black" />
                    </g>
                </svg>
            </span>
        </button>
        <div class="d-flex align-items-baseline flex-wrap mr-5">
            <h5 class="text-dark font-weight-bold my-1 mr-5">
                #@Model.IDCanHo
            </h5>
            <ul class="breadcrumb breadcrumb-transparent breadcrumb-dot font-weight-bold p-0 my-2 ">
                <li class="breadcrumb-item text-muted">
                    <a href="" class="text-muted">@Resources.App.CanHo</a>
                </li>
                <li class="breadcrumb-item text-muted">
                    <a href="" class="text-muted">  @Resources.App.ChinhSuaTinDang</a>
                </li>
            </ul>
        </div>
    </div>
    <div class="d-flex align-items-center">
        <a href="@Url.Action("Index", "CanHo")" class="btn btn-default font-weight-bold  px-3 font-size-base  mr-2"> <i class="icon-1x text-dark-50 flaticon-reply"></i> @Resources.App.QuayLai</a>
        <div class="btn-group ml-2">
            <button type="button" class="btn btn-primary font-weight-bold btn-sm px-3 font-size-base" id="btn-save">
                <i class="icon-1x text-dark-50 ki ki-solid-plus"></i>
                @Resources.App.CapNhat
            </button>
        </div>
    </div>
}

<div class="card card-custom">
    <div class="card-header">

        <div class="card-toolbar">
            <ul class="nav nav-light-danger nav-bold nav-pills">
                <li class="nav-item ">
                    <a class="nav-link active" data-toggle="tab" href="#tab_hoso">
                        <span class="nav-icon">
                            <i class="flaticon-layer"></i>
                        </span>
                        <span class="nav-text">Thông tin chính</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" data-toggle="tab" href="#tab_hinhanh">
                        <span class="nav-icon">
                            <i class="flaticon2-image-file"></i>
                        </span>
                        <span class="nav-text">Hình ảnh</span>
                    </a>
                </li>
                @*<li class="nav-item ">
                        <a class="nav-link" data-toggle="tab" href="#tab_diachi">
                            <span class="nav-icon">
                                <i class="flaticon-placeholder-3"></i>
                            </span>
                            <span class="nav-text">Địa chỉ</span>
                        </a>
                    </li>

                    <li class="nav-item">
                            <a class="nav-link" data-toggle="tab" href="#tab_dinhkem">
                                <span class="nav-icon">
                                    <i class="flaticon-attachment"></i>
                                </span>
                                <span class="nav-text">Đính kèm</span>
                            </a>
                        </li>
                    <li class="nav-item">
                        <a class="nav-link" data-toggle="tab" href="#tab_bosung">
                            <span class="nav-icon">
                                <i class="flaticon-interface-9"></i>
                            </span>
                            <span class="nav-text">Tính năng bổ sung</span>
                        </a>
                    </li>*@
            </ul>
        </div>
    </div>
    <div class="card-body">
        <div class="tab-content">
            <div class="tab-pane fade  active show" id="tab_hoso" role="tabpanel" aria-labelledby="tab_hoso">
                <div id="txt-thongtinchunha">
                    <h4>Thông tin chủ nhà</h4>
                    <div class="form-group row">
                        <div class="col-lg-2">
                            <label class="form-label">Tên chủ nhà<b class="text-danger">*</b></label>
                            <input type="text" class="form-control form-control-solid" id="txt-tenchunha" placeholder="Tên chủ nhà" name="txt-tenchunha">
                            <div class="d-md-none mb-2"></div>
                        </div>
                        <div class="col-lg-2">
                            <label class="form-label">Quốc tịch</label>
                            <input type="text" class="form-control" id="txt-quoctich" placeholder="">
                        </div>
                        <div class="col-lg-5">
                            <label class="form-label">Ghi chú</label>
                            <input type="text" class="form-control" id="txt-ghichu" placeholder="">
                        </div>
                        <div class="col-md-2 pt-6">
                            <button href="" class="btn btn-primary font-weight-bold btn-sm mt-2" onclick="CapNhatChuNha()">
                                <i class="icon-1x text-dark-50 ki ki-solid-plus"></i> Thêm chủ nhà
                            </button>
                        </div>
                    </div>
                    <div id="kt_repeater_1">
                        <div class="form-group row" id="kt_repeater_1">
                            <div data-repeater-list="" class="col-lg-12" id='thongtinchitietchunha'>
                                <div data-repeater-item class="form-group row align-items-center">
                                    <div class="col-md-2">
                                        <label>Tên:</label>
                                        <input type="text" class="form-control" placeholder="Tên liên hệ" />
                                        <div class="d-md-none mb-2"></div>
                                    </div>
                                    <div class="col-md-2">
                                        <label>SĐT <b class="text-danger"> *</b></label>
                                        <input type="text" class="form-control" placeholder="Số điện thoại" required />
                                        <div class="d-md-none mb-2"></div>
                                    </div>
                                    <div class="col-md-2">
                                        <label>Email</label>
                                        <input type="text" class="form-control" placeholder="Địa chỉ email" />
                                        <div class="d-md-none mb-2"></div>
                                    </div>
                                    <div class="col-md-2 pt-6">
                                        <a href="#" data-repeater-delete="" class="btn btn-sm font-weight-bolder btn-light-danger mt-2">
                                            <i class="la la-trash-o"></i> Xóa
                                        </a>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="form-group row  justify-content-end">
                            <div class="col-lg-2  text-right">
                                <a href="javascript:;" data-repeater-create="" class="btn btn-sm font-weight-bolder btn-light-primary">
                                    <i class="la la-plus"></i> Thêm
                                </a>
                            </div>
                            <div class="col-lg-4">

                            </div>
                        </div>
                    </div>
                </div>
                <hr />
                <form id="inputform" class="form" data-parsley-validate>
                    <div class="form-group row">
                        <div class="col-lg-2">
                            <label class="form-label">Chủ nhà<b class="text-danger">*</b></label>
                            <div id="select-chunha">
                            </div>
                        </div>
                        <div class="col-lg-2">
                            <label class="form-label">Dự án <b class="text-danger">*</b></label>
                            <div id="select-duan">
                            </div>
                        </div>
                        <div class="col-lg-2 ">
                            <label class="form-label">Tháp<span class="text-danger text-cost" id="text-thap"></span></label>
                            <input type="text" id="txt-thap" class="form-control" placeholder="Nhập tháp" value="@Model.Thap">
                        </div>
                        <div class="col-lg-2 ">
                            <label class="form-label">Tầng <b class="text-danger">*</b><span class="text-danger text-cost" id="text-txttang"></span></label>
                            <input type="text" id="txt-tang" class="form-control" placeholder="Nhập tầng" required value="@Model.Tang">
                        </div>
                        <div class="col-lg-2 ">
                            <label class="form-label">Số căn <b class="text-danger">*</b><span class="text-danger text-cost" id="text-txtsocang"></span></label>
                            <input type="text" id="txt-socan" class="form-control" placeholder="Nhập số căn" value="@Model.SoCan" required>
                        </div>
                        <div class="col-lg-2">
                            <label class="form-label">Diện tích </label>
                            <div id="txt-dientich">
                            </div>
                        </div>

                    </div>
                    <div class="separator separator-dashed my-5"></div>
                    <div class="form-group row">
                        <div class="col-lg-2">
                            <label class="form-label">Hướng cửa</label>
                            <div id="select-huongcua">
                            </div>
                        </div>
                        <div class="col-lg-2">
                            <label class="form-label">Hướng ban công</label>
                            <div id="select-huongbancong">
                            </div>
                        </div>
                        <div class="col-lg-2">
                            <label class="form-label">Số PN</label>
                            <div id="txt-sophongngu">
                            </div>
                        </div>
                        <div class="col-lg-2">
                            <label class="form-label">Số WC</label>
                            <div id="txt-sowc">
                            </div>
                        </div>
                        <div class="col-lg-4">
                            <label class="form-label">View</label>
                            <input type="text" id="txt-views" class="form-control" placeholder="Nhập view" value="@Model.View">
                        </div>
                    </div>

                    <div class="form-group row">

                        <div class="col-lg-2">
                            <label class="form-label">Tình trạng CH<b class="text-danger">*</b></label>
                            <div id="select-tinhtrangcanho">
                            </div>
                        </div>
                        <div class="col-lg-2">
                            <label class="form-label">Loại căn hộ<b class="text-danger">*</b></label>
                            <div id="select-loaicanho">
                            </div>
                        </div>
                        <div class="col-lg-2">
                            <label class="form-label">Loại bàn giao</label>
                            <div id="select-loaibangiao">
                            </div>
                        </div>
                        <div class="col-lg-4">
                            <label class="form-label">Video Link</label>
                            <input type="text" id="txt-videolink" class="form-control" placeholder="Nhập video link" value="@Model.VideoLink">

                        </div>
                        <div class="col-lg-2 ">
                            <label class="form-label">Mật khẩu cửa<span class="text-danger text-cost" id="text-txttmatkhaucua"></span></label>
                            <input type="text" id="txt-matkhaucua" class="form-control" placeholder="Nhập mật khẩu cửa" value="@Model.MatKhauCua">
                        </div>
                    </div>
                    <div class="separator separator-dashed my-5"></div>
                    <div class="form-group row">

                        <div class="col-lg-2">
                            <label class="form-label">Giá hợp đồng<span class="text-danger text-cost" id="text-giahopdong"></span></label>

                            <div class="input-group input-group-solid">
                                <div id="txt-giahopdong" class="form-control">
                                </div>
                                <div class="input-group-append ">
                                    <select class="form-control selectpicker tien-bg" id="txt-giaHD">
                                        <option value="ty" @if (Model.GiaHopDongDVT == "ty") { ViewContext.Writer.Write("selected"); }>Tỷ</option>
                                        <option value="trieu" @if (Model.GiaHopDongDVT == "trieu") { ViewContext.Writer.Write("selected"); }>Triệu</option>
                                    </select>
                                </div>
                            </div>

                        </div>
                        <div class="col-lg-2">
                            <label class="form-label">Giá chủ nhà gửi<span class="text-danger text-cost" id="text-giachunhagui"></span></label>
                            <div class="input-group input-group-solid">
                                <div id="txt-giachunhagui" class="form-control">
                                </div>
                                <div class="input-group-append ">
                                    <select class="form-control selectpicker tien-bg" id="tien-chunhagui">
                                        <option value="ty" @if (Model.GiaChuNhaGuiDVT == "ty") { ViewContext.Writer.Write("selected"); }>Tỷ</option>
                                        <option value="trieu" @if (Model.GiaChuNhaGuiDVT == "trieu") { ViewContext.Writer.Write("selected"); }>Triệu</option>
                                    </select>

                                </div>
                            </div>
                        </div>
                        @*<div class="col-lg-2">
                <label class="form-label">Giá chào bán<span class="text-danger text-cost" id="text-giachaoban"></span></label>
                <div class="input-group input-group-solid">
                    <div id="txt-giachaoban" class="form-control">
                    </div>
                    <div class="input-group-append ">
                        <select class="form-control selectpicker tien-bg" id="tien-chaoban">
                            <option value="ty" @if (Model.GiaChaoBanDVT == "ty") { ViewContext.Writer.Write("selected"); }>Tỷ</option>
                            <option value="trieu" @if (Model.GiaChaoBanDVT == "trieu") { ViewContext.Writer.Write("selected"); }>Triệu</option>
                        </select>

                    </div>
                </div>
            </div>*@
                        <div class="col-lg-2">
                            <label class="form-label">Giá bán<span class="text-danger text-cost" id="text-giaban"></span></label>
                            <div class="input-group input-group-solid">
                                <div id="txt-giaban" class="form-control">
                                </div>
                                <div class="input-group-append ">
                                    <select class="form-control selectpicker tien-bg" id="txt-tiengiaban">
                                        <option value="ty" @if (Model.GIaBanDVT == "ty") { ViewContext.Writer.Write("selected"); }>Tỷ</option>
                                        <option value="trieu" @if (Model.GIaBanDVT == "trieu") { ViewContext.Writer.Write("selected"); }>Triệu</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                        <div class="col-lg-2">
                            <label class="form-label">Giá chốt bán<span class="text-danger text-cost" id="text-giachotban"></span></label>
                            <div class="input-group input-group-solid">
                                <div id="txt-giachotban" class="form-control">
                                </div>
                                <div class="input-group-append ">
                                    <select class="form-control selectpicker tien-bg" id="tien-chotban">
                                        <option value="ty" @if (Model.GiaChotBanDVT == "ty") { ViewContext.Writer.Write("selected"); }>Tỷ</option>
                                        <option value="trieu" @if (Model.GiaChotBanDVT == "trieu") { ViewContext.Writer.Write("selected"); }>Triệu</option>
                                    </select>

                                </div>
                            </div>
                        </div>
                        <div class="col-lg-2">
                            <label class="form-label">Giá thuê net<span class="text-danger text-cost" id="text-giathuenet"></span></label>
                            <div class="input-group input-group-solid">
                                <div id="txt-giathuenet" class="form-control">
                                </div>
                                <div class="input-group-append ">
                                    <select class="form-control selectpicker tien-bg" id="tien-thuenet">
                                        <option value="ty" @if (Model.GiaThueNetDVT == "ty") { ViewContext.Writer.Write("selected"); }>Tỷ</option>
                                        <option value="trieu" @if (Model.GiaThueNetDVT == "trieu") { ViewContext.Writer.Write("selected"); }>Triệu</option>
                                    </select>

                                </div>
                            </div>
                        </div>
                        <div class="col-lg-2">
                            <label class="form-label">Giá thuê bao phí<span class="text-danger text-cost" id="text-giathuebaophi"></span></label>
                            <div class="input-group input-group-solid">
                                <div id="txt-giathuebaophi" class="form-control">
                                </div>
                                <div class="input-group-append ">
                                    <select class="form-control selectpicker tien-bg" id="tien-thuebaophi">
                                        <option value="ty" @if (Model.GIaThueBaoPhiDVT == "ty") { ViewContext.Writer.Write("selected"); }>Tỷ</option>
                                        <option value="trieu" @if (Model.GIaThueBaoPhiDVT == "trieu") { ViewContext.Writer.Write("selected"); }>Triệu</option>
                                    </select>

                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="separator separator-dashed my-5"></div>
                    <div class="form-group row">
                        <div class="col-lg-2 ">
                            <label class="form-label">Giá hợp đồng (USD)<span class="text-danger text-cost" id="text-giahopdongUSD"></span></label>
                            <div id="txt-giahopdongUSD">
                            </div>
                        </div>
                        <div class="col-lg-2 ">
                            <label class="form-label">Giá chủ nhà gửi (USD)<span class="text-danger text-cost" id="text-giachunhaguiUSD"></span></label>
                            <div id="txt-giachunhaguiUSD">
                            </div>
                        </div>
                        @*<div class="col-lg-2 ">
                <label class="form-label">Giá chào bàn (USD)<span class="text-danger text-cost" id="text-giachaobanUSD"></span></label>
                <div id="txt-giachaobanUSD">
                </div>
            </div>*@
                        <div class="col-lg-2">
                            <label class="form-label">Giá bán(USD)<span class="text-danger text-cost" id="text-giabanUSD"></span></label>
                            <div id="txt-giabanUSD">
                            </div>
                        </div>
                        <div class="col-lg-2 ">
                            <label class="form-label">Giá chốt bán (USD)<span class="text-danger text-cost" id="text-giachotbanUSD"></span></label>
                            <div id="txt-giachotbanUSD">
                            </div>
                        </div>
                        <div class="col-lg-2 ">
                            <label class="form-label">Giá thuê net (USD)<span class="text-danger text-cost" id="text-giathuenetUSD"></span></label>
                            <div id="txt-giathuenetUSD">
                            </div>
                        </div>
                        <div class="col-lg-2 ">
                            <label class="form-label">Giá thuê bao phí (USD)<span class="text-danger text-cost" id="text-giathuebaophiUSD"></span></label>
                            <div id="txt-giathuebaophiUSD">
                            </div>
                        </div>
                    </div>
                    <div class="separator separator-dashed my-5"></div>
                    <div class="form-group row">
                        <div class="col-lg-4 ">
                            <div class="form-group">
                                <label class="form-label">Ghi chú Admin<span class="text-danger text-cost"></span></label>
                                <textarea id="txt-ghichuadmin" class="form-control" rows="2" placeholder="Nhập nội dung ghi chú cho admin">@Model.GhiChuAdmin</textarea>
                            </div>
                        </div>
                        <div class="col-lg-4">
                            <div class="form-group">
                                <label class="form-label">Ghi chú quản lí<span class="text-danger text-cost"></span></label>
                                <textarea id="txt-ghichuquanly" class="form-control" rows="2" placeholder="Nhập nội dung ghi chú cho quản lí">@Model.GhiChuQuanLy</textarea>
                            </div>
                        </div>
                        <div class="col-lg-4">
                            <div class="form-group">
                                <label class="form-label">Ghi chú Sales<span class="text-danger text-cost"></span></label>
                                <textarea id="txt-ghichusale" class="form-control" rows="2" placeholder="Nhập nội dung ghi chú cho sale">@Model.GhiChuSales</textarea>
                            </div>
                            <div class="form-group">
                                <div id="list_ghichusale"></div>
                            </div>
                        </div>
                    </div>
                    @*<div class="form-group row">
                    <div class="col-lg-2">
                        <label class="form-label">Giá bán<span class="text-danger text-cost" id="text-giaban"></span></label>
                        <div class="input-group input-group-solid">
                            <div id="txt-giaban" class="form-control">
                            </div>
                            <div class="input-group-append ">
                                <select class="form-control selectpicker tien-bg" id="txt-tiengiaban">
                                    <option value="ty" @if (Model.GIaBanDVT == "ty") { ViewContext.Writer.Write("selected"); }>Tỷ</option>
                                    <option value="trieu" @if (Model.GIaBanDVT == "trieu") { ViewContext.Writer.Write("selected"); }>Triệu</option>
                                </select>
                            </div>
                        </div>
                    </div>
                    <div class="col-lg-2">
                        <label class="form-label">Giá bán(USD)<span class="text-danger text-cost" id="text-giabanUSD"></span></label>
                        <div id="txt-giabanUSD">
                        </div>
                    </div>
                   <div class="col-lg-2">
                        <label class="form-label">Giá góc<span class="text-danger text-cost" id="text-giagoc"></span></label>
                        <div class="input-group input-group-solid">
                            <div id="txt-giagoc" class="form-control">
                            </div>
                            <div class="input-group-append ">
                                <select class="form-control selectpicker tien-bg" id="txt-tiengiagoc">
                                    <option value="ty" @if (Model.GiaGocDVT == "ty") { ViewContext.Writer.Write("selected"); }>Tỷ</option>
                                    <option value="trieu" @if (Model.GiaGocDVT == "trieu") { ViewContext.Writer.Write("selected"); }>Triệu</option>
                                </select>
                            </div>
                        </div>
                    </div>
                    <div class="col-lg-2 ">

                        <label class="form-label">Giá góc(USD)<span class="text-danger text-cost" id="text-giagocUSD"></span></label>
                        <div id="txt-giagocUSD">
                        </div>
                    </div>
                </div>*@
                            @*<div class="separator separator-dashed my-5"></div>
                <div class="row">
                    <div class="col-lg-12">
                        <div id="txt_noidung-toolbar"></div>
                        <div id="txt_noidung" class="ck-blurred ck ck-content ck-editor__editable ck-rounded-corners ck-editor__editable_inline cus-border" lang="en" dir="ltr" role="textbox" aria-label="Rich Text Editor, main" contenteditable="true"></div>
                    </div>
                </div>*@

                </form>
            </div>
            
            <div class="tab-pane fade" id="tab_hinhanh" role="tabpanel" aria-labelledby="tab_hinhanh">
                <div class="row">
                    <div class="col-sm-6" id="pnHinhAnh" >
                        <div class="uppy uppy-full-width" id="fhinh_anh">
                            <div class="uppy-dashboard"></div>
                            <div class="uppy-progress"></div>
                        </div>
                    </div>
                    <div class="col-sm-6">
                        <div class="card card-custom card-stretch">
                            <div class="card-header">
                                <div class="card-title">
                                    <h3 class="card-label">Hình ảnh đã tải lên</h3>
                                    <button type="button" class="btn btn-danger font-weight-bold px-3 font-size-base " id="btn-save" onclick="XoaAllHinh()">
                                        <i class="icon-1x la la-trash"></i>
                                        Xóa
                                    </button>
                                </div>
                            </div>
                            <div class="card-body" id="listHinh">
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
@section ScriptsFile{
    <script src="~/Scripts/ckeditor-document.bundle.js"></script>
    <script src="~/Scripts/uppy.bundle.js"></script>
    <script src="~/Scripts/parsley.min.js"></script>
}
@section CustomScripts{
    <script type="text/javascript">
        var hinhdaidien = '@Model.HinhDaiDien';
        var chuNha = '@Model.IDChuNha', hinhdaup = 0;
        $('body').addClass('subheader-fixed');
        $(function () {
            loadChuNha1()
            $.get('@Url.Action("getTinhTrangCanHo", "ThongTin")', function (rs) {
                $("#select-tinhtrangcanho").dxSelectBox({
                    items: rs,
                    placeholder: 'Chọn tình trạng..',
                    showClearButton: true,
                    searchEnabled: true,
                    value:Number('@Model.IDTinhTrangCH') > 0 ? Number('@Model.IDTinhTrangCH') : null,
                    valueExpr: "tinhtrangcanho",
                    displayExpr: "tentinhtrangcanho",
                }).dxValidator({ validationRules: [{ type: "required", message: "Tình trạng không được trống!" }] });


            });
              $.get('@Url.Action("getDuAn", "ThongTin")', function (rs) {
                $("#select-duan").dxSelectBox({
                    items: rs,
                    placeholder: 'Chọn dự án..',
                    showClearButton: true,
                    searchEnabled: true,
                    valueExpr: "duan",
                    displayExpr: "ten_duan",
                    value:Number('@Model.IDDuAn') > 0 ? Number('@Model.IDDuAn') : null,
                }).dxValidator({ validationRules: [{ type: "required", message: "Dự án không được trống!" }] });

      
            });

            $("#txt-views").dxTextBox({ placeholder: "Nhập view" });
           // $("#txt-matkhaucua").dxTextBox({ placeholder: "Nhập mật khẩu cửa" });
            $("#txt-giahopdongUSD").dxNumberBox({
                showSpinButtons: false,
                showClearButton: true,
                format: "###,###.##", min: 0,
                value: Number('@Model.GiaHopDongUSD') > 0 ? Number('@Model.GiaHopDongUSD') : null,
            });
            $("#txt-giachunhaguiUSD").dxNumberBox({
                showSpinButtons: false,
                showClearButton: true,
                format: "###,###.##", min: 0,
                value: Number('@Model.GiaChuNhaGuiUSD') > 0 ? Number('@Model.GiaChuNhaGuiUSD') : null,
            });
            $("#txt-giachaobanUSD").dxNumberBox({
                showSpinButtons: false,
                showClearButton: true,
                format: "###,###.##", min: 0,
                 value: Number('@Model.GiaChaoBanUSD') > 0 ? Number('@Model.GiaChaoBanUSD') : null,
            });
            $("#txt-giachotbanUSD").dxNumberBox({
                showSpinButtons: false,
                showClearButton: true,
                format: "###,###.##", min: 0,
                value: Number('@Model.GiaChotBanUSD') > 0 ? Number('@Model.GiaChotBanUSD') : null,
            });
            $("#txt-giathuenetUSD").dxNumberBox({
                showSpinButtons: false,
                showClearButton: true,
                format: "###,###.##", min: 0,
                value: Number('@Model.GiaThueNetUSD') > 0 ? Number('@Model.GiaThueNetUSD') : null,
            });
            $("#txt-giathuebaophiUSD").dxNumberBox({
                showSpinButtons: false,
                showClearButton: true,
                format: "###,###.##", min: 0,
                value: Number('@Model.GiaThueBaoPhiUSD') > 0 ? Number('@Model.GiaThueBaoPhiUSD') : null,
            });
            $("#txt-giaban").dxNumberBox({
                showSpinButtons: false,
                showClearButton: true,
                format: "###,###.##",
                min: 0,
                 value: Number('@Model.GiaBan') > 0 ? Number('@Model.GiaBan') : null,
            });
            $("#txt-giabanUSD").dxNumberBox({
                showSpinButtons: false,
                showClearButton: true,
                format: "###,###.##", min: 0,
                value: Number('@Model.GiaBanUSD') > 0 ? Number('@Model.GiaBanUSD') : null,
            });
             @*$("#txt-giagoc").dxNumberBox({
                showSpinButtons: false,
                showClearButton: true,
                format: "###,###.##",
                min: 0,
                 value: Number('@Model.GiaGoc') > 0 ? Number('@Model.GiaGoc') : null,
            });
            $("#txt-giagocUSD").dxNumberBox({
                showSpinButtons: false,
                showClearButton: true,
                format: "###,###.##", min: 0,
                value: Number('@Model.GiaGocUSD') > 0 ? Number('@Model.GiaGocUSD') : null,
            });*@

    
            $('body').addClass('subheader-fixed');
            $("#txt-dientich").dxNumberBox({
                showSpinButtons: true,
                showClearButton: true,
                format: "###,###.## ㎡",
                value: Number('@Model.DienTich') > 0 ? Number('@Model.DienTich') : null,
                min:5
            });

            $("#txt-sophongngu").dxSelectBox({
                items: @Html.Raw(RealEstate.Libs.ThongTin.GetSoPhongNgu()),
                placeholder: 'Chọn số phòng ngủ..',
                showClearButton: true,
                searchEnabled: true,
                valueExpr: "phong_ngu",
                displayExpr: "phong_ngu",
                value: '@Model.PhongNgu',
            });
            $("#txt-sowc").dxSelectBox({
                items: @Html.Raw(RealEstate.Libs.ThongTin.GetSoPhongWC()),
                placeholder: 'Chọn số WC..',
                showClearButton: true,
                searchEnabled: true,
                value: '@Model.WC',
                valueExpr: "wc",
                displayExpr: "wc",
            });
            $("#txt-giahopdong").dxNumberBox({
                showSpinButtons: false,
                showClearButton: true,
                format: "###,###.##", min: 0,
                value: Number('@Model.GiaHopDong') > 0 ? Number('@Model.GiaHopDong') : null,

            });
            $("#txt-giachunhagui").dxNumberBox({
                showSpinButtons: false,
                showClearButton: true,
                format: "###,###.##", min: 0,
                value: Number('@Model.GiaChuNhaGui') > 0 ? Number('@Model.GiaChuNhaGui') : null,
            });
            $("#txt-giachaoban").dxNumberBox({
                showSpinButtons: false,
                showClearButton: true,
                format: "###,###.##", min: 0,
                value: Number('@Model.GiaChaoBan') > 0 ? Number('@Model.GiaChaoBan') : null,
            });
            $("#txt-giachotban").dxNumberBox({
                showSpinButtons: false,
                showClearButton: true,
                format: "###,###.##", step: 10,
                min: 0,
                value: Number('@Model.GiaChotBan') > 0 ? Number('@Model.GiaChotBan') : null,
            });
            $("#txt-giathuenet").dxNumberBox({
                showSpinButtons: false,
                showClearButton: true,
                format: "###,###.##",
                min: 0,
                 value: Number('@Model.GiaThueNet') > 0 ? Number('@Model.GiaThueNet') : null,
            });
            $("#txt-giathuebaophi").dxNumberBox({
                showSpinButtons: false,
                showClearButton: true,
                format: "###,###.##",
                step: 10, min: 0,
                value: Number('@Model.GiaThueBaoPhi') > 0 ? Number('@Model.GiaThueBaoPhi') : null,
            });

          
            setDanhMuc1('select-huongcua',@Html.Raw(RealEstate.Libs.ThongTin.GetDanhMucString("huong")), false, 'Hướng cửa',Number('@Model.HuongCua') > 0 ? Number('@Model.HuongCua') : null);
            setDanhMuc1('select-huongbancong',@Html.Raw(RealEstate.Libs.ThongTin.GetDanhMucString("huong")), false, 'Hướng ban công',Number('@Model.HuongBanCong') > 0 ? Number('@Model.HuongBanCong') : null);
            setDanhMuc1('select-loaicanho',@Html.Raw(RealEstate.Libs.ThongTin.GetDanhMucString("loai")), true, 'Loại căn hộ',Number('@Model.IDLoaiCanHo') > 0 ? Number('@Model.IDLoaiCanHo') : null);
            setDanhMuc1('select-loaibangiao',@Html.Raw(RealEstate.Libs.ThongTin.GetDanhMucString("loai-ban-giao")), true, 'Loại bàn giao',Number('@Model.IDLoaiBanGiao') > 0 ? Number('@Model.IDLoaiBanGiao') : null);
            loadFile();
            const Tus = Uppy.Tus;
            const ProgressBar = Uppy.ProgressBar;
            const StatusBar = Uppy.StatusBar;
            const FileInput = Uppy.FileInput;
            const Informer = Uppy.Informer;
            @*

            const Dashboard = Uppy.Dashboard;

            var id = '#fhinh_anh';

            var options = {
                proudlyDisplayPoweredByUppy: false,
                target: id,
                inline: true,

                replaceTargetContent: true,
                showProgressDetails: true,

                allowMultipleUploads:true,
                note: 'Chỉ chấp nhận hình ảnh tối đa 2MB',
                height: $(window).height() - 350,

                browserBackButtonClose: true
            }

            var uppyDashboard = Uppy.Core({
                autoProceed: true,
                restrictions: {
                    maxFileSize: 2097152,
                    maxNumberOfFiles: 6,
                    minNumberOfFiles: 1,
                    allowedFileTypes: ['image/*', 'video/*']
                }
            });
                  const XHRUpload = Uppy.XHRUpload;
            uppyDashboard.setMeta({ id: '@imgs_key', HinhDaiDien:hinhdaidien });
            uppyDashboard.use(XHRUpload, {
                endpoint: '@Url.Action("UploadImagesEdit", "CanHo")',
                formData: true,
                fieldName: 'files[]'
            });
            uppyDashboard.on('upload-success', (file, response) => {
                if (response.rs_code == 1) {
                    ShowToast.success(response.body.rs_text, 3000);
                    loadFile();
                }
                else {
                    ShowToast.info(response.body.rs_text, 3000);
                }
            });
            uppyDashboard.on('complete', function (file) {
                loadFile();
                uppyDashboard = null;
            });
            uppyDashboard.use(Dashboard, options);*@
            $('#btn-save').click(function () {
                Save(1);
            });

            $('#kt_repeater_1').repeater({
                initEmpty: false,

                defaultValues: {
                    'text-input': 'foo'
                },

                show: function () {
                    $(this).slideDown();
                },

                hide: function (deleteElement) {

                    Swal.fire({
                        title: "Cảnh báo?",
                        html: '<b class="text-danger">Bạn có chắc xóa thông tin đang chọn không?</b>!',
                        icon: "warning",
                        showCancelButton: true,
                        confirmButtonText: "Có, xóa ngay!",
                        cancelButtonText: "Hủy!",
                        reverseButtons: true
                    }).then(function (result) {
                        if (result.value) {
                            $(this).slideUp(deleteElement);
                            ShowToast.success('Đã xóa tính năng bổ sung', 3000);
                        } else if (result.dismiss === "cancel") {
                            ShowToast.info('Bạn đã hủy xóa thông tin', 3000);

                        }
                    });
                }
            });
            getThongTinChuNha(chuNha)
        });
        @*function loadChuNha() {
            $.get('@Url.Action("getChuNha", "ThongTin")', function (rs) {
                $("#select-chunha").dxSelectBox({
                    items: rs,
                    placeholder: 'Chọn chủ nhà..',
                    showClearButton: true,
                    searchEnabled: true,
                    valueExpr: "IdChuNha",
                    displayExpr: "TenChuNha",
                    value:Number(chuNha) > 0 ? Number(chuNha) : null,
                    onValueChanged: function (data) {
                        getThongTinChuNha(data.value);
                    }
                }).dxValidator({ validationRules: [{ type: "required", message:  "Chủ nhà không được trống!" }] });

            });
        }*@
         function loadChuNha1() {
            $.get('@Url.Action("vChuNha", "ThongTin")', function (rs) {
                $("#select-chunha").dxDropDownBox({
                    dataSource: new DevExpress.data.ArrayStore({ key: "IdChuNha", data: rs }),
                    valueExpr: "IdChuNha",
                deferRendering: false,
                    placeholder: "Chọn chủ nhà..",
                displayExpr: function (item) {
                                if (item)
                                    return item.LienHe;
                                else return null;
                            },
                showClearButton: false,
                value: Number(chuNha) > 0 ? Number(chuNha) : null,
                onOpened: function (e) {
                                var drw = 550;
                                var popupInstance = e.element.find(".dx-popup").dxPopup("instance"); popupInstance.option('width', drw); popupInstance.off("optionChanged", optionChangedHandler); popupInstance.on("optionChanged", optionChangedHandler); function optionChangedHandler(args) { if (args.name == "width" && args.value < drw) { args.component.option("width", drw); } } e.component.getDataSource().reload();
                            },
                contentTemplate: function (e) {
                                var value = e.component.option("value"),
                                    $dataGrid = $("<div>").dxDataGrid({
                                        dataSource: e.component.getDataSource(),
                                        filterRow: {
                                            visible: true,
                                            applyFilter: "auto"
                                        },
                                        columns: [{ dataField: 'LienHe', caption: 'Thông tin' }],
                            hoverStateEnabled: true, pager: { showPageSizeSelector: true, showInfo: true }, rowAlternationEnabled: true, showBorders: true, hoverStateEnabled: false, allowColumnReordering: true, allowColumnResizing: true, columnAutoWidth: true, selection: { mode: "single" }, selectedRowKeys: [value], height: "100%",
                            onSelectionChanged: function (selectedItems) {
                                        var keys = selectedItems.selectedRowKeys, hasSelection = keys.length; e.component.option("value", hasSelection ? keys[0] : null); if (hasSelection) { e.component.close(); }
                                    }});
                                dataGrid = $dataGrid.dxDataGrid("instance");
                                e.component.on("valueChanged", function (args) {
                                    dataGrid.selectRows(args.value, false);
                                    getThongTinChuNha(args.value);
                                });
                                return $dataGrid;
                            }
                        }).dxValidator({ validationRules: [{ type: "required" }] });
                    });
        }
        function getThongTinChuNha(idChuNha) {
            chuNha = idChuNha;
            $("#thongtinchitietchunha").html('');
            if (idChuNha === null) {
                $("#txt-tenchunha").val('');
                $("#txt-quoctich").val('');
                $("#txt-ghichu").val('');
                $("#thongtinchitietchunha").append('<div data-repeater-item class="form-group row align-items-center"><div class="col-md-2"><label>Tên:</label><input type="text" class="form-control" placeholder="Tên liên hệ" value = "" /></div><div class="col-md-2"> <label>SĐT <b class="text-danger"> *</b></label><input type="text" id = "0" class="form-control" placeholder="Số điện thoại" value ="" /></div><div class="col-md-2"> <label>Email</label><input type="text" class="form-control" placeholder="Địa chỉ email" value =""/></div><div class="col-md-2 pt-6"> <a href="javascript:;" data-repeater-delete="" class="btn btn-sm font-weight-bolder btn-light-danger mt-2"><i class="la la-trash-o"></i> Xóa</a></div></div>');
            }
            else {
                $("#thongtinchitietchunha").html('');
                $.get('@Url.Action("getThongTinChiTietChuNha", "ThongTin")', { id: idChuNha }).done(function (rs) {
                $("#txt-tenchunha").val(rs.ChuNha.TenChuNha);
                $("#txt-quoctich").val(rs.ChuNha.QuocTich);
                $("#txt-ghichu").val(rs.ChuNha.GhiChu);
                $("#kt_repeater_1").html = "";
                for (var i = 0; i < rs.ChuNhaThongTin.length; i++) {
                    $("#thongtinchitietchunha").append('<div data-repeater-item class="form-group row align-items-center"><div class="col-md-2"><label>Tên:</label><input type="text" class="form-control" placeholder="Tên liên hệ" value = "' + rs.ChuNhaThongTin[i].Ten + '" /></div><div class="col-md-2"> <label>SĐT <b class="text-danger"> *</b></label><input id = "' + rs.ChuNhaThongTin[i].Id + '" type="text" class="form-control" placeholder="Số điện thoại" value ="' + rs.ChuNhaThongTin[i].SoDienThoai + '" /></div><div class="col-md-2"> <label>Email</label><input type="text" class="form-control" placeholder="Địa chỉ email" value ="' + rs.ChuNhaThongTin[i].EMail + '"/></div><div class="col-md-2 pt-6"> <a href="javascript:;" class="btn btn-sm font-weight-bolder btn-light-danger mt-2" onclick = "XoaThongTinChiTietChuNha(this)" id ="' + rs.ChuNhaThongTin[i].Id + '"><i class="la la-trash-o"></i> Xóa</a></div></div>');
                }

            });
            }
        }
        function XoaThongTinChiTietChuNha(a) {
            var data = {};
            data.__RequestVerificationToken = $('input[name="__RequestVerificationToken"]').val();
            data.Id = a.id; 
             Swal.fire({
                title: "Cảnh báo?",
                html: 'Bạn có chắc xóa thông tin đang chọn không?<br />. Đã xóa thì không thể khôi phục được!',
                icon: "warning",
                showCancelButton: true,
                confirmButtonText: "Có, xóa ngay!",
                cancelButtonText: "Hủy!",
                reverseButtons: true
            }).then(function (result) {
                if (result.value) {
                    $.post("@Url.Action("XoaThongTinChuNha","ThongTin")", data).done(function (rs) {
                        if (rs.rs_code = 1) {
                            ShowToast.success('Xóa file thành công', 3000);
                            getThongTinChuNha(chuNha);
                        }
                        else {
                            ShowToast.warning(rs.rs_text, 3000);
                        }
                    }).fail(function () {
                        ShowToast.warning('Có lỗi xảy ra', 3000);
                    });
                } else if (result.dismiss === "cancel") {
                    ShowToast.info('Bạn đã hủy xóa thông tin', 3000);

                }
            });
           
           
        }
        function SetHinhDaiDien(a) {
            hinhdaidien = a.defaultValue;
        }
        function CapNhatChuNha() {
            var check = false;
            var data = {};
            var dataChuNha = {};
            if ($("#txt-tenchunha").val() === null || $("#txt-tenchunha").val().trim() == "")
                check = true;
            dataChuNha.TenChuNha = $("#txt-tenchunha").val();
            dataChuNha.QuocTich = $("#txt-quoctich").val();
            dataChuNha.GhiChu = $("#txt-ghichu").val();
            dataChuNha.IDChuNha = chuNha;
            data.ChuNha = dataChuNha;
            var tn = [];
            var ten = '', sodt, d = 1,id;
            $("#kt_repeater_1  input").each(function () {
                var gt = $(this).val();
                if (d % 3 == 0) {
                    tn.push({ Ten: ten, SoDienThoai: sodt, EMail: gt,Id:id });
                    ten = sodt = "",id = 0;
                    d = 0;
                }
                else {
                    if (d == 1) {
                        ten = gt;
                    }
                    else if (d == 2) {
                        if (gt.trim().length == 0) {
                            check = true;
                        }
                        else {
                            sodt = gt;
                        }
                        id = Number($(this).attr("id")) > 0 ? $(this).attr("id") : 0;
                    }
                }
                d++;
            });
            if (check) {
                ShowToast.warning('Chưa nhập tên chủ nhà hoặc số điện thoại', 3000);
                return;
            }
            data.ChuNhaThongTin = tn;
            data.__RequestVerificationToken = $('input[name="__RequestVerificationToken"]').val();
            if (chuNha === null || chuNha == "") {

                $.post('@Url.Action("AddChuNha", "ThongTin")', data).done(function (rs) {
                    if (rs.rs_code == 1) {
                        chuNha = rs.rs_data;
                        loadChuNha1();
                        getThongTinChuNha(chuNha);
                    } else {
                        Swal.fire("Có lỗi!", rs.rs_text, "error");
                    }
                    }).fail(function () {
                        KTApp.unblockPage();
                        ShowToast.warning('Có lỗi xảy ra', 3000);
                    });
            }
            else {
                 $.post('@Url.Action("EditChuNha", "ThongTin")', data).done(function (rs) {
                    if (rs.rs_code == 1) {
                        chuNha = rs.rs_data;
                        loadChuNha1();
                        getThongTinChuNha(chuNha);
                    } else {
                        Swal.fire("Có lỗi!", rs.rs_text, "error");
                    }
                    }).fail(function () {
                        KTApp.unblockPage();
                        ShowToast.warning('Có lỗi xảy ra', 3000);
                    });
            }
            
        }
        function loadFile() {
            $('#listHinh,#pnHinhAnh').empty();
            $.get('@Url.Action("GetFileImagesEdit", "CanHo")', { id: '@imgs_key',post:'@imgs_key' }).done(function (rs) {
                var check = '';
                hinhdaup = rs.length;
                 $('#pnHinhAnh').html('<div class="uppy uppy-full-width" id="fhinh_anh"> <div class="uppy-dashboard"></div> <div class="uppy-progress"></div> </div>');
                if (hinhdaup < Number('@ViewBag.dangtin_hinhtoida')) {
                    const Dashboard = Uppy.Dashboard;
                    var id = '#fhinh_anh';
                    var options = {
                        proudlyDisplayPoweredByUppy: false,
                        target: id,
                        inline: true,
                        replaceTargetContent: true,
                        showProgressDetails: true,
                        allowMultipleUploads: true,
                        note: 'Chỉ chấp nhận hình ảnh tối đa 2MB',
                        height: $(window).height() - 350,
                        browserBackButtonClose: true
                    }
                    var uppyDashboard = Uppy.Core({
                        autoProceed: true,
                        restrictions: {
                            maxFileSize: 2097152,
                            maxNumberOfFiles: Number('@ViewBag.dangtin_hinhtoida') - hinhdaup,
                            minNumberOfFiles: hinhdaup == 0 ? Number('@ViewBag.dangtin_hinhtoithieu') : (hinhdaup < Number('@ViewBag.dangtin_hinhtoithieu') ? Number('@ViewBag.dangtin_hinhtoithieu') - hinhdaup : 1),
                            allowedFileTypes: ['image/*', 'video/*']
                        }
                    });
                    try {
                        const XHRUpload = Uppy.XHRUpload;
                        uppyDashboard.setMeta({ id: '@imgs_key' });
                        uppyDashboard.use(XHRUpload, {
                            endpoint: '@Url.Action("UploadImagesEdit", "CanHo")',
                            formData: true,
                            fieldName: 'files[]'
                        });
                        uppyDashboard.on('complete', function (file) {
                            loadFile();
                        });
                        uppyDashboard.use(Dashboard, options);
                    } catch (ex) {
                        console.log(ex);
                    }
                } else {
                    $('#pnHinhAnh').html('<h3 class="text-warning text-primary text-center pt-10 mt-10">Bạn đã tải lên tối đa @ViewBag.dangtin_hinhtoida hình ảnh</h3>');
                }
                 $.each(rs, function (i, v) {
                        check = ''
                        if (v.HinhDaiDien) {
                            check = 'checked';
                        }else {
                            check = '';
                        }
                        $('#listHinh').append('<div class="d-flex flex-wrap align-items-center mb-10">  <div class="symbol symbol-60 symbol-2by3 flex-shrink-0"> <div class="symbol-label" style="background-image: url(\'' + v.Url + '\')"></div> </div>  <div class="d-flex flex-column ml-4 flex-grow-1 mr-2"> <a href="' + v.Url + '" target="_blank" class="text-dark-75 font-weight-bold text-hover-primary font-size-lg mb-1" name = "' + v.Url + '">' + v.TenHinh + '</a> <span class="text-muted font-weight-bold">Size: ' + v.Size + '</span> <div class="radio-inline"> <label class="radio radio-solid  pt-3"><input type="radio" onchange= "SetHinhDaiDien(this)"  name="check-dd" value="' + v.TenHinh + '" ' + check + '><span></span> Hình đại diện</label>  </div></div>     <a href="javascript:;" id = "' + v.ID +'" onclick="xoahinhanh(this)" name="' + v.TenHinh +'" class="btn btn-sm font-weight-bolder btn-light-danger mt-2"><i class="la la-trash-o"></i>Xóa</a> </div>');
                    });
                });
        }
        function xoahinhanh(a) {
            var name = $(a).attr("name");
            if (name == hinhdaidien) {
                alert("Phải chọn hình đại diện khác mới xóa hình này được");
                return;
            }
            Swal.fire({
                title: "Cảnh báo?",
                html: 'Bạn có chắc xóa hình ảnh đang chọn không?<br />. Hình ảnh đã xóa thì không thể khôi phục được!',
                icon: "warning",
                showCancelButton: true,
                confirmButtonText: "Có, xóa ngay!",
                cancelButtonText: "Hủy!",
                reverseButtons: true
            }).then(function (result) {
                if (result.value) {
                    KTApp.blockPage({
                        overlayColor: '#000000',
                        state: 'primary',
                        message: 'Đang xóa...'
                    });
                    $.post('@Url.Action("XoaFileEdit", "CanHo")', { id: a.id }).done(function (rs) {
                        KTApp.unblockPage();
                        if (rs.rs_code == 1) {
                            ShowToast.success('Xóa file thành công', 3000);
                            loadFile();
                        } else {
                            Swal.fire("Có lỗi!", rs.rs_text, "error");

                        }
                    }).fail(function () {
                        KTApp.unblockPage();
                        ShowToast.warning('Có lỗi xảy ra', 3000);
                    });
                } else if (result.dismiss === "cancel") {
                    ShowToast.info('Bạn đã hủy xóa hình ảnh', 3000);

                }
            });
        }
        function Save(step) {
            var validate = true;
            var data = {};
            //data.TieuDe = $("#txt-title").val();
            data.IDCanHo = "@imgs_key";
            data.IDChuNha = $("#select-chunha").dxDropDownBox("instance").option('value');
            if (!data.IDChuNha) {
                validate = false;
                $('#select-chunha').dxValidator('instance').validate();
            }
            data.IDDuAn = $("#select-duan").dxSelectBox("instance").option('value');
            if (!data.IDDuAn) {
                validate = false;
                $('#select-duan').dxValidator('instance').validate();
            }
            data.Thap = $('#txt-thap').val();
            data.Tang = $('#txt-tang').val();
            data.SoCan = $('#txt-socan').val();
            data.DienTich = $('#txt-dientich').dxNumberBox('instance').option('value');
            data.HuongCua = $("#select-huongcua").dxSelectBox("instance").option('value');
            data.HuongBanCong = $("#select-huongbancong").dxSelectBox("instance").option('value');
            data.PhongNgu = $('#txt-sophongngu').dxSelectBox('instance').option('value');
            data.WC = $('#txt-sowc').dxSelectBox('instance').option('value');
            data.View = $('#txt-views').val();
            data.IDTinhTrangCH = $("#select-tinhtrangcanho").dxSelectBox("instance").option('value');
            data.IDLoaiCanHo = $("#select-loaicanho").dxSelectBox("instance").option('value');
            data.IDLoaiBanGiao = $("#select-loaibangiao").dxSelectBox("instance").option('value');
            data.VideoLink = $("#txt-videolink").val();
            data.MatKhauCua = $('#txt-matkhaucua').val();
            data.GiaHopDong = $('#txt-giahopdong').dxNumberBox('instance').option('value');
            data.GiaHopDongDVT = $('#txt-giaHD').val();
            data.GiaChuNhaGui = $('#txt-giachunhagui').dxNumberBox('instance').option('value');
            data.GiaChuNhaGuiDVT = $('#tien-chunhagui').val();
            data.GiaChotBan = $('#txt-giachotban').dxNumberBox('instance').option('value');
            data.GiaChotBanDVT = $('#tien-chotban').val();
            //data.GiaChaoBan = $('#txt-giachaoban').dxNumberBox('instance').option('value');
            //data.GiaChaoBanDVT = $('#tien-chaoban').val();
            data.GiaThueNet = $('#txt-giathuenet').dxNumberBox('instance').option('value');
            data.GiaThueNetDVT = $('#tien-thuenet').val();
            data.GiaThueBaoPhi = $('#txt-giathuebaophi').dxNumberBox('instance').option('value');
            data.GIaThueBaoPhiDVT = $('#tien-thuebaophi').val();

            data.GiaHopDongUSD = $('#txt-giahopdongUSD').dxNumberBox('instance').option('value');
            data.GiaChuNhaGuiUSD = $('#txt-giachunhaguiUSD').dxNumberBox('instance').option('value');
            //data.GiaChaoBanUSD = $('#txt-giachaobanUSD').dxNumberBox('instance').option('value');
            data.GiaChotBanUSD = $('#txt-giachotbanUSD').dxNumberBox('instance').option('value');
            data.GiaThueNetUSD = $('#txt-giathuenetUSD').dxNumberBox('instance').option('value');
            data.GiaThueBaoPhiUSD = $('#txt-giathuebaophiUSD').dxNumberBox('instance').option('value');

            data.GiaBan = $('#txt-giaban').dxNumberBox('instance').option('value');
            data.GIaBanDVT = $('#txt-tiengiaban').val();
            data.GiaBanUSD = $('#txt-giabanUSD').dxNumberBox('instance').option('value');
            data.GhiChuAdmin = $('#txt-ghichuadmin').val();
            data.GhiChuQuanLy = $('#txt-ghichuquanly').val();
            data.GhiChuSales = $('#txt-ghichusale').val();
            //data.GiaGoc = $('#txt-giagoc').dxNumberBox('instance').option('value');
            //data.GiaGocDVT = $('#txt-tiengiagoc').val();
            //data.GiaGocUSD = $('#txt-giagocUSD').dxNumberBox('instance').option('value');

            data.HinhDaiDien = hinhdaidien;
            data.__RequestVerificationToken = $('input[name="__RequestVerificationToken"]').val();
            data.imgs_key = "@imgs_key";
            if ($('#inputform').parsley().validate() && validate) {
                KTApp.blockPage({
                    overlayColor: '#000000',
                    state: 'primary',
                    message: 'Processing...'
                });
                $.post('@Url.Action("EditSubmit", "CanHo")', data).done(function (rs) {
                    KTApp.unblockPage();
                    if (rs.rs_code ==1) {
                        ShowToast.success('Thành công', 3000);
                        @*window.location.href = '@Url.Action("Edit", "CanHo")?id=' + "@imgs_key";*@
                    } else {
                        Swal.fire("Có lỗi!", rs.rs_text, "error");

                    }
                }).fail(function () {
                    KTApp.unblockPage();
                    ShowToast.warning('Có lỗi xảy ra', 3000);
                });
            } else {
                ShowToast.warning('Bạn cần nhập đủ các trường bắt buộc trước khi lưu', 3000);
            }
        }
        function XoaAllHinh() {
            var data = {}
            data.id = "@imgs_key";
            data.__RequestVerificationToken = $('input[name="__RequestVerificationToken"]').val();
             KTApp.blockPage({
                    overlayColor: '#000000',
                    state: 'primary',
                    message: 'Processing...'
                });
            $.post("@Url.Action("XoaHinhAllEdit", "CanHo")", data).done(function (rs) {
                if (rs.rs_code == 1) {
                        KTApp.unblockPage();
                    ShowToast.success('Thành công', 3000);
                    hinhdaup = 0;
                    $('#listHinh').html('');
                    } else {
                        KTApp.unblockPage();
                        Swal.fire("Có lỗi! ", rs.rs_text, "error");

                    }
            }).fail(function () {
                KTApp.unblockPage();
                Swal.fire("Có lỗi! ");
            })
        }
    </script>
}